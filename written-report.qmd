---
---
title: "Airbnbs in New York City"
author: "Team lol: Tamsin Connerly, Hannah Lee, Jasmine Jiang"
date: "3/17/25"
format: pdf
execute: 
  warning: false
  message: false
  echo: false
editor: visual
bibliography: references.bib
---

```{r}
#| label: load packages and data

library(tidyverse)
library(tidymodels)
library(knitr)
install.packages("patchwork")
library(patchwork)
library(rms)

airbnb <- read.csv("data/listings.csv")
```

## Introduction

The rise of short-term rental platforms, particularly Airbnb, has significantly disrupted the traditional hospitality industry and transformed urban housing markets worldwide. In New York City, one of the world's most popular tourist destinations, the impact of Airbnb has been particularly pronounced, raising questions about its effects on local communities, housing affordability, and the broader urban economy.

Previous research has identified several factors that impact Airbnb pricing. One study found that host attributes, site and property attributes, amenities and services, rental rules, and online review ratings all play significant roles in determining listing prices [@wang2017]. Furthermore, recent studies have provided evidence of Airbnb's influence on housing markets. Another study found that a 1% increase in Airbnb listings leads to a 0.018% increase in rents and a 0.026% increase in house prices [@barron2018a]. This effect is more pronounced in areas with a lower share of owner-occupiers, suggesting that non-owner-occupiers are more likely to reallocate their properties from long-term to short-term rentals.

Our research question is: "How do various factors, such as bedroom number, room type, review scores, and neighborhood, influence the price of Airbnb listings in New York City?" 

Understanding the determinants of Airbnb pricing in New York City is crucial for several reasons. Firstly, it can provide valuable insights for policymakers grappling with the challenges posed by the growth of short-term rentals, including potential impacts on housing affordability and neighborhood character [@toader2021a]. Secondly, it can help hosts make more informed pricing decisions, potentially leading to more efficient market outcomes.

Based on existing literature and our understanding of the New York City housing market, we hypothesize that:

-   Listings with more bedrooms will command higher prices, reflecting the premium placed on space in urban environments.

-   The type of room (entire home/apartment vs. private room) will significantly impact pricing, with entire homes/apartments having a higher price.

-   Higher review scores will be associated with higher prices, as positive feedback may justify premium pricing.

-   Properties in more affluent neighborhoods like Manhattan will have higher prices compared to less affluent ones like the Bronx because of real estate price differences in each borough.

### Exploratory Data Analysis

The Airbnb dataset that we are utilizing can be found on Inside Airbnb (<https://insideairbnb.com/>). Inside Airbnb has randomly collected data on dozens of countries and cities, but we decided to focus on New York City. The data was sourced from publicly available data on the Airbnb website on March 1, 2025.

Each row in the dataset represents a unique Airbnb listing in New York City. Each of these correspond to individual properties available for rental on the platform and have many (58) variables such as name of the listing, latitude and longitude, room type, price, minimum number of nights required for booking, total number of reviews the listing has reviewed, and more.

## Univariate Exploratory Data Analysis

### Response Variable - Price

```{r}
#| label: visualization-01
#| echo: false

ggplot(data = airbnb, aes(x = price)) +
  geom_histogram(bins = 100) +
  labs(title = "Distribution of Airbnb Prices in New York City", 
       x = "Listing Price (USD)", 
       y = "Count")
```

```{r}
#| label: figure-02
tidy(summary(airbnb$price)) |>
  kable(digits = 3)
```

The distribution is pretty heavily right skewed, as can be seen from both of the histograms. It is difficult to analyze the distribution in the first histogram because there is an outlier at \$20,000 and makes the bins and binwidth very narrow and zoomed out (since the range of the data is too large). It is also clear that this outlier impacts the mean, since the median of \$140 is quite a bit less than the mean of around \$213.84, and the mean is roughly equal to the 3rd quartile which is also around \$240. We have removed this outlier for our analysis.

```{r}
#| label: figure-03

airbnb <- airbnb |>
  filter(price < 2500)

ggplot(airbnb, aes(x = price)) +
  geom_histogram() +
  labs(title = "Closer Look at Distribution of Price (Removed Outliers)", 
       x = "Listing Price (USD)", 
       y = "Count") 
```

We can see that the distribution is still right skewed, and the vast majority of the listings seem to cost between \$50-\$200. Because of this skewedness, we also plan to apply log transformation to this variable to address the skew of the response variable.

### Predictor Variable - Bedrooms

```{r}
#| label: figure-04

tidy(summary(airbnb$bedrooms)) |>
  kable(digits = 3)

airbnb <- airbnb |>
  filter(bedrooms >= 0)
```

The distribution of the number of bedrooms for Airbnb listings in New York City is skewed to the right, as the mean is greater than the median. Since there are 17 NA values, we will drop them for our analysis.

### Predictor Variable - Review Scores

```{r}
#| label: figure-07

tidy(summary(airbnb$review_scores_rating)) |>
  kable(digits = 3)
```

The distribution of the predictor variable review score is skewed left, with the median of 4.85 being slightly higher than the mean of 4.724. The majority of the reviews are around 5 (over 6000), and the vast majority of the observations are between 4 and 5, with very few of them being below 3. Additionally, there are 6733 NA values.

To account for the NAs, we will filter the dataset to include only listings with 5 or more reviews, since the median number of reviews for a listing is 5.

```{r}
#| label: data-transformation
#| echo: false

airbnb <- airbnb |>
  filter(number_of_reviews >= 5)
```

```{r}
#| label: figure-07.5
#| echo: false

ggplot(data = airbnb, aes(x = review_scores_rating)) +
  geom_histogram() +
  labs(title = "Distribution of Average Airbnb 
  Review Scores in New York City with at Least 5 Reviews", 
       x = "Average Review Score (out of 5.0)", 
       y = "Count") 
```

```{r}
#| label: review-filtered-summary

tidy(summary(airbnb$review_scores_rating)) |>
  kable(digits = 3)
```

The distribution of review scores is still skewed left, with a median of 4.82 and a mean of 4.765. The minimum review score has increased from 1 to 2.44, and the third quartile review score has decreased from 5 to 4.93.

### Predictor Variable - Room Type

```{r}
#| label: figure-08
ggplot(airbnb, aes(x = room_type)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Distribution of Room Types",
    x = "Room Type",
    y = "Count"
  ) +
  theme_minimal() 
```

The most frequent room type in this dataset is Entire home/apt, followed by private room; these may be more popular and sought out. There are very few hotel rooms and even fewer shared rooms.

### Predictor Variable - Neighborhood

```{r}
#| label: figure-10

ggplot(airbnb, aes(x = neighbourhood_group_cleansed)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Distribution of Neighbourhood Groups",
    x = "Neighbourhood Group",
    y = "Count"
  ) +
  theme_minimal()
```

```{r}
#| label: figure-11

table(airbnb$neighbourhood_group_cleansed)|>
  kable(digits = 3)
```

The greatest number listings are in Brooklyn (4408), followed by Brooklyn (4151), and Queens (2142). A few of them are in Bronx and even fewer in Staten Island. This is to be expected, as Manhattan and Brooklyn are prime areas for tourism and business, while other areas might be less popular for short-term rentals.

## Bivariate Exploratory Data Analysis

### Response (Price) vs Predictor Variable (review scores)

```{r}
#| label: figure-13

ggplot(airbnb, aes(x = review_scores_rating, y = price)) +
  geom_point(alpha = 0.5) +
  labs(title = "Price vs. Review Score",
       x = "Review Score",
       y = "Price (USD)") +
  theme(
    plot.title = element_text(size = 20),      
    axis.title = element_text(size = 16),                     
    axis.text = element_text(size = 14),                      
    legend.title = element_text(size = 14),                    
    legend.text = element_text(size = 12)                     
  )

```

This scatter plot shows the relationship between price and review scores. However, it looks a little problematic and hard to interpret because high data density at certain score levels, especially between 4 and 5. Since the price variable is highly skewed, we applied a log transformation to try to help spread out values and make trends more visible.

```{r}
#| label: figure-14

airbnb <- airbnb |>
  filter(price <= quantile(price, 0.99))

ggplot(airbnb, aes(x = review_scores_rating, y = log(price))) +
  geom_jitter(alpha = 0.3) +  # Adds slight randomness to reduce overlap
  labs(title = "Log-Transformed Price vs. Review Score",
       x = "Review Score",
       y = "Log of Price (USD)") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20),      
    axis.title = element_text(size = 16),                     
    axis.text = element_text(size = 14),                      
    legend.title = element_text(size = 14),                    
    legend.text = element_text(size = 12)                     
  )
```

The majority of listings have review scores between 4 and 5, this shows that most listings have scores within this range. Higher-rated listings tend to have slightly higher prices, but the effect is weak.

### Response (Price) vs Predictor Variable (number of prices)

```{r}
#| label: figure-12  
ggplot(airbnb, aes(x = bedrooms, y = log(price))) +   
  geom_point(alpha = 0.5) +   
  labs(title = "Log Price vs. Number of Bedrooms",        
       x = "Number of Bedrooms",        
       y = "Price (USD)") 
```

This scatter plot visualizes the relationship between the number of bedrooms and the price of Airbnb listings in New York City. There is not a clear trend. However, listings with 0 to 5 bedrooms exhibit a wide range of prices, with some listings priced significantly higher than the majority. Some outliers even exceed \$10,000 per night, likely representing luxury or highly unique accommodations. This indicates that other factors such as location, room type, and review scores may have a stronger influence on pricing.

### Response (Price) vs Predictor Variable (Room Type)

```{r}
#| label: figure-16

ggplot(airbnb, aes(x = reorder(room_type, price, median), y = log(price))) +
  geom_boxplot() +
  labs(title = "Log-Transformed Price Distribution by Room Type",
       x = "Room Type",
       y = "Log of Price (USD)") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20),      
    axis.title = element_text(size = 16),                     
    axis.text = element_text(size = 14),                      
    legend.title = element_text(size = 14),                    
    legend.text = element_text(size = 12)                     
  )
```

According to this plot, hotel rooms have the highest median price and general highest price among all room types, suggesting that they are generally priced higher than other Airbnb listings such as shared room and private room, etc. Also, the IQR for hotel rooms and entire homes/apartments is larger compared to private and shared rooms, indicating greater variation in pricing.

### Response (Price) vs Predictor Variable (Neighborhood)

```{r}
#| label: figure-18

airbnb <- airbnb |>
  mutate(neighbourhood_group_cleansed = reorder(neighbourhood_group_cleansed, price, median))

ggplot(airbnb, aes(x = neighbourhood_group_cleansed, y = log(price))) +
  geom_boxplot(outlier.size = 0.5) +
  coord_flip() +  # Flip for readability
  labs(title = "Log-Transformed Price Distribution 
       by Neighborhood",
       x = "Neighborhood",
       y = "Log of Price (USD)") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 10)) +
  theme(
    plot.title = element_text(size = 20),      
    axis.title = element_text(size = 16),                     
    axis.text = element_text(size = 14),                      
    legend.title = element_text(size = 14),                    
    legend.text = element_text(size = 12)                     
  )
```

According to this plot, we can see that Manhattan has the highest median price, showing that it is the most expensive borough for Airbnb listings. It alsoexhibits the widest IQR, suggesting a high variation in listing prices. The median of Brooklyn follows Manhattan, with a slightly lower median price but still a wider spread. There are still some outliers shown in the plot, but the interpretability is much better.

## Interaction Effects

### Bedrooms and Room Type

```{r}
#| label: figure-19
#| warning: FALSE
#| echo: FALSE

airbnb <- airbnb |>
  mutate(log_price = log(price))

airbnb |>
  ggplot(aes(x = bedrooms, y = log(price), color = room_type)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Log Price vs. Bedrooms by Room Type",
       x = "Number of Bedrooms",
       y = "Log Price (log($))",
       color = "Type of Room") +
  theme(
    plot.title = element_text(size = 20),      
    axis.title = element_text(size = 16),                     
    axis.text = element_text(size = 14),                      
    legend.title = element_text(size = 14),                    
    legend.text = element_text(size = 12)                     
  )
```

Based on the graph, it appears that the rate at which price increases per number of bedrooms varies across room types. The slope of the shared room especially seems to differ from the others. Thus, there may be an interaction effect here.

### Bedrooms and Neighborhood

```{r}
#| label: figure-20
#| warning: FALSE
#| echo: false

airbnb |>
  ggplot(aes(x = bedrooms, y = log(price), color = neighbourhood_group_cleansed)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Log Price vs. Bedrooms by Neighborhood",
       x = "Number of Bedrooms",
       y = "Log Price (log($))",
       color = "Neighborhood") +
  theme(
    plot.title = element_text(size = 20),      
    axis.title = element_text(size = 16),                     
    axis.text = element_text(size = 14),                      
    legend.title = element_text(size = 14),                    
    legend.text = element_text(size = 12)                     
  )
```

Based on the graph visually, it appears that the rate at which price increases per bedroom does not greatly vary based on neighborhood, especially compared to the previous graph by room type. Staten Island does have a noticeably different slope, though. Thus, there is a potential for an interaction effect between bedroom number and neighborhood, but not as much as the previous graph with bedroom and room type.

## Building the Model

### Multiple Linear Regression With No Interaction

```{r}
#| label: model-without-interaction

airbnb_fit <- lm(log_price ~ bedrooms + room_type + review_scores_rating 
                           + neighbourhood_group_cleansed, data = airbnb)

tidy(airbnb_fit) |>
  kable(digits = 3)
```

### Multiple Linear Regression with Interaction Effects

```{r}
#| label: model-interaction

airbnb_fit_interaction <- lm(log_price ~ bedrooms + room_type + review_scores_rating 
                           + neighbourhood_group_cleansed + bedrooms * room_type, data = airbnb)

tidy(airbnb_fit_interaction) |>
  kable(digits = 3)
```

### Evaluating the Models

```{r}
#| label: r2-values

glance(airbnb_fit) |>
  select(r.squared, adj.r.squared) |>
  kable(digits = 3)
glance(airbnb_fit_interaction) |>
  select(r.squared, adj.r.squared) |>
  kable(digits = 3)

```

The model that includes the interaction effect between bedrooms and room type seems to perform slightly better, with higher $r^2$ and adjusted $r^2$ values of 0.391 and 0.39, respectively.

```{r}
#| label: drop-in-deviance

dropdev <- anova(airbnb_fit, airbnb_fit_interaction, test = "Chisq") |>
  kable(digits = 3)

dropdev

```

The results from the drop in deviance test also support this, as the p-value is less than the threshold, indicating that including the interaction terms is able to significantly improve the model's ability to explain variation in log price.

```{r}
#| label: check-multicollinearity

vif(airbnb_fit) |>
  as.data.frame() |>
  `colnames<-`("VIF") |>
  tibble::rownames_to_column("Predictor") |>
  kable(digits = 3)

vif(airbnb_fit_interaction) |>
  as.data.frame() |>
  `colnames<-`("VIF") |>
  tibble::rownames_to_column("Predictor") |>
  kable(digits = 3)

```

### Assumption Check

```{r}
#| label: linearity-and-equal-variance

# model without interaction terms
ggplot(augment(airbnb_fit), aes(.fitted, .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Residuals vs Fitted Values (without interaction terms)",
       x = "Fitted Values", 
       y = "Residuals")

# model with interaction terms
ggplot(augment(airbnb_fit_interaction), aes(.fitted, .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Residuals vs Fitted Values (with interaction terms)",
       x = "Fitted Values", 
       y = "Residuals")
```

According to the residual plots, for both models without and with interaction terms, the residuals are centered around 0, which suggests that linearity is satisfied. However, both plots show a mild equal variance because there’s a slight funnel shape – residuals seem more spread out at lower fitted values and slightly tighter at higher fitted values. There are also few vertical lines of the residuals, indicating discrete fitted values, likely due to categorical variables like room type or neighborhood.

The normality is fine because our dataset has more than 10,000 data points, which is large enough (n \> 30) to satisfy the normality assumption.

The independence is reasonably satisfied because each row in the dataset represents a distinct Airbnb listing, and the data is randomly collected. There is no indication of temporal or spatial autocorrelation, and there are no repeated measurements from the same listing.
